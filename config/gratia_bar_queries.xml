<graphtool-config>

  <import file="$CONFIG_ROOT/generic_queries.xml" />

  <class type="SqlQueries" name="GratiaBarQueries">

    <attribute name="display_name"> Bar Graphs </attribute>
     
    <attribute name="connection_manager"> GratiaConnMan </attribute>

    <query name="facility_hours_bar" base="GratiaGenericQuery.jobs_query">
      <sql>
        <filler name="group"> S.SiteName </filler>
        <filler name="column"> sum(WallDuration)/3600 </filler>
        <filler name="where"> AND WallDuration > 0 </filler>
      </sql>
      <attribute name="pivot_name">Facility</attribute>
      <attribute name="title">Hours Spent on Jobs By Facility</attribute>
      <attribute name="graph_type">GratiaStackedBar</attribute>
      <results>
        <inputs>
          <input name="grouping_transform">make_int</input>
        </inputs>
      </results>
    </query>

    <query name="vo_hours_bar" base="GratiaGenericQuery.jobs_query">
      <sql>
        <filler name="group"> VO.VOName </filler>
        <filler name="column"> sum(WallDuration)/3600 </filler>
        <filler name="where"> AND WallDuration > 0 </filler>
      </sql>
      <attribute name="pivot_name">VO</attribute>
      <attribute name="title">Hours Spent on Jobs By VO</attribute>
      <attribute name="graph_type">GratiaStackedBar</attribute>
      <results>
        <inputs>
          <input name="grouping_transform">make_int</input>
        </inputs>
      </results>
    </query>

  </class>

</graphtool-config>
